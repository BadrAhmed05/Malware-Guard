import os
import numpy as np
import LoadData as ld
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score
import pickle

dataset_root = 'train and test'

X_train, y_train = ld.load_data_and_labels(os.path.join(dataset_root, 'train'))

X_test, y_test = ld.load_data_and_labels(os.path.join(dataset_root, 'test'))

X_train = np.array(X_train)
X_test = np.array(X_test)

rf_model = RandomForestClassifier(n_estimators=100, random_state=42)
rf_model.fit(X_train, y_train)

rf_predictions = rf_model.predict(X_test)
rf_accuracy = accuracy_score(y_test, rf_predictions)
print(f"Random Forest Model Accuracy: {rf_accuracy}")

with open('random_forest_model.pkl', 'wb') as f:
    pickle.dump(rf_model, f)
