import os
import sys
import pickle
import LoadData as ld
from sklearn.tree import DecisionTreeClassifier
from sklearn.metrics import accuracy_score

# Append the directory containing 'LoadData.py' to sys.path
sys.path.append('LoadData.py')

# Set the path to your dataset root directory
dataset_root = 'train and test'

# Load data and labels from the training set
X_train, y_train = ld.load_data_and_labels(os.path.join(dataset_root, 'train'))

# Load data and labels from the testing set
X_test, y_test = ld.load_data_and_labels(os.path.join(dataset_root, 'test'))

# Decision Tree classification
dt_model = DecisionTreeClassifier()
dt_model.fit(X_train, y_train)

# Save the trained Decision Tree model using pickle
model_filename = 'decision_tree_model.pkl'
with open(model_filename, 'wb') as file:
    pickle.dump(dt_model, file)

# Evaluate the Decision Tree model
dt_predictions = dt_model.predict(X_test)
dt_accuracy = accuracy_score(y_test, dt_predictions)
print(f"Decision Tree Model Accuracy: {dt_accuracy}")
