import os
import numpy as np
import LoadData as ld
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
import pickle

dataset_root = 'train and test'

X_train, y_train = ld.load_data_and_labels(os.path.join(dataset_root, 'train'))

X_test, y_test = ld.load_data_and_labels(os.path.join(dataset_root, 'test'))

X_train = np.array(X_train)
X_test = np.array(X_test)

logistic_model = LogisticRegression(max_iter=1000)  # You can adjust the maximum number of iterations
logistic_model.fit(X_train, y_train)

logistic_predictions = logistic_model.predict(X_test)
logistic_accuracy = accuracy_score(y_test, logistic_predictions)
print(f"Logistic Regression Model Accuracy: {logistic_accuracy}")

with open('logistic_regression_model.pkl', 'wb') as f:
    pickle.dump(logistic_model, f)
